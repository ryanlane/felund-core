# Felund Rendezvous — nginx snippet
# Include inside your server {} block, adjusting root and fastcgi_pass as needed.
#
# Example standalone server block:
#
#   server {
#       listen 8000;
#       server_name _;
#       root /var/www/felund/api/php;
#       include /etc/nginx/felund_rendezvous.conf;
#   }

index rendezvous.php;

# Block direct access to the SQLite database
location ~* \.sqlite$ {
    deny all;
    return 404;
}

# Block access to the data/ directory
location ^~ /data/ {
    deny all;
    return 404;
}

# Route all /v1/* requests through the PHP file
location /v1/ {
    try_files $uri /rendezvous.php$is_args$args;
}

# PHP-FPM handler — adjust the socket path to match your setup
location ~ \.php$ {
    try_files $uri =404;
    fastcgi_pass unix:/run/php/php8.1-fpm.sock;  # adjust version as needed
    fastcgi_index rendezvous.php;
    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
    include fastcgi_params;
}
